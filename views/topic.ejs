<% include layout_top %>
<div class="content">
<div class="topic-detail border">
<div class="topic-header">话题详情</div>
<div class="topic-title"><h3><%= topic.title %></h3><hr /></div>
<div class="topic-content"><%= topic.content %><hr /></div>
<div class="topic-info">
<span class="topic-nickname">作者：<%= topic.nickname %></span>
<span class="topic-time">发布时间：<%= topic.time %></span>
<span class="topic-count">查看数：<%= topic.viewCount %></span>
</div>
</div>
<div class="comment-list border">
<div class="topic-header"><%= topic.replyCount%>评论</div>
<div class="comment-detail">
<div class="comment-info">
<span class="topic-nickname">作者：<%= topic.nickname %></span>
<span class="topic-time">发布时间：<%= topic.time %></span>
<span class="topic-count">查看数：<%= topic.viewCount %></span>
</div>
<div class="comment-content"><%= topic.content %></div>
</div>
</div>
</div>
<div class="sidebar">
侧栏
</div>
<div id="modal_new_topic" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">发布新话题</h3>
  </div>
  <div class="modal-body">
    <form id="form_new_topic" action="new_topic" method="post">
        <fieldset>
            <p>
            <label>标题</label>
            <input id="title" type="text" name="title" class="input-xlarge">
            </p>
            <p>
            <label>正文</label>
            <textarea id="content" name="content" rows="10" cols="30" class="input-xlarge"></textarea>
            </p>
        </fieldset>
  </form>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">取消</button>
    <button id="btn_topic_publish" class="btn btn-primary">发布</button>
  </div>
</div>
<script type="text/javascript" src='/javascripts/jquery.validate.min.js'></script>
<script type="text/javascript">
$(document).ready(function() {
    $("#btn_new_topic").click(function() {
        $('#modal_new_topic').modal('show');
    });

    $('#form_new_topic').validate({
        rules : {
            title: {
                required: true
            },
            content: {
                required: true
            }
        },
        messages : {
            title: {
                required : '标题不能为空'
            },
            content: {
                required: '正文不能为空'
            }
        }
    });

    $("#btn_topic_publish").click(function() {
        if($("#form_new_topic").valid()) {
            var posting = $.post("new_topic", $("#form_new_topic").serialize());
            posting.done(function(data) {
                if(data.result) {
                    $('#modal_new_topic').modal('hide');
                }
                alert(data.message);
            });
        }
    });
});
</script>
<% include layout_bottom %>
